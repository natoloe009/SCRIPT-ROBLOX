local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local Button1 = Instance.new("TextButton")
local Button2 = Instance.new("TextButton")
local Button3 = Instance.new("TextButton")  -- FIXED: Added definition for Button3

ScreenGui.Parent = game:GetService("CoreGui")
ScreenGui.Name = "CustomGui"

-- Frame settings
Frame.Parent = ScreenGui
Frame.Size = UDim2.new(0, 300, 0, 200)  -- Fixed size for better control
Frame.Position = UDim2.new(0.5, -150, 0.5, -100)  -- Centered
Frame.BackgroundColor3 = Color3.fromRGB(255, 255, 255)

-- Button1: Copy Position
Button1.Parent = Frame
Button1.Size = UDim2.new(1, -20, 0, 40)
Button1.Position = UDim2.new(0, 10, 0, 10)
Button1.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Button1.Text = "Copy Position"
Button1.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Button2: Copy CFrame
Button2.Parent = Frame
Button2.Size = UDim2.new(1, -20, 0, 40)
Button2.Position = UDim2.new(0, 10, 0, 60)
Button2.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Button2.Text = "Copy CFrame"
Button2.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Button3: Destroy GUI (FIXED)
Button3.Parent = Frame
Button3.Size = UDim2.new(1, -20, 0, 40)
Button3.Position = UDim2.new(0, 10, 0, 110)
Button3.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
Button3.Text = "Destroy GUI"
Button3.TextColor3 = Color3.fromRGB(255, 255, 255)

-- Dragging Logic
local dragging, dragInput, dragStart, startPos

local function update(input)
    local delta = input.Position - dragStart
    Frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

Frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = Frame.Position

        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

Frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)

game:GetService("UserInputService").InputChanged:Connect(function(input)
    if input == dragInput and dragging then
        update(input)
    end
end)

-- Button actions
Button1.MouseButton1Click:Connect(function()
    local pos = game.Players.LocalPlayer.Character.HumanoidRootPart.Position
    setclipboard(tostring(pos))
    print("Position copied to clipboard!")
end)

Button2.MouseButton1Click:Connect(function()
    local cf = game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame
    setclipboard(tostring(cf))
    print("CFrame copied to clipboard!")
end)

Button3.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
    print("GUI destroyed.")
end)

-- Rainbow background effect
coroutine.wrap(function()
    local t = 0
    while Frame.Parent do
        t += 0.01
        local r = math.floor(math.sin(t) * 127 + 128)
        local g = math.floor(math.sin(t + 2) * 127 + 128)
        local b = math.floor(math.sin(t + 4) * 127 + 128)
        Frame.BackgroundColor3 = Color3.fromRGB(r, g, b)
        task.wait(0.01)
    end
end)()
